var save = '<div id=\x27chromeadd\x27 class=\x27toolbar_view--toolButtonContainer--1HAfB\x27><span id=\x27trymeout\x27 class=\x27svg-container toolbar_view--iconButton--Zxsnv enabledButton-3\x27><svg xmlns=\x27http://www.w3.org/2000/svg\x27 width=\x2722\x27 height=\x2722\x27 viewBox=\x270 0 26 26\x27 fill=\x27none\x27 style=\x27stroke: #FFF;margin-left: auto;margin-right: auto;\x27><path d=\x27M12.9998 23.8333C18.9829 23.8333 23.8332 18.9831 23.8332 13C23.8332 7.0169 18.9829 2.16666 12.9998 2.16666C7.01675 2.16666 2.1665 7.0169 2.1665 13C2.1665 18.9831 7.01675 23.8333 12.9998 23.8333Z\x27 stroke=\x27white\x27 stroke-width=\x27.9\x27 stroke-linecap=\x27round\x27 stroke-linejoin=\x27round\x27/><path d=\x27M10.8335 8.66666L17.3335 13L10.8335 17.3333V8.66666Z\x27 stroke=\x27white\x27 stroke-width=\x27.9\x27 stroke-linecap=\x27square\x27/></svg></span></div>';
var googleButton = '<svg width="187" height="43" viewBox="0 0 187 43" fill="none" xmlns="http://www.w3.org/2000/svg"><g filter="url(#filter0_dd)"><path fill-rule="evenodd" clip-rule="evenodd" d="M3 1C1.89543 1 1 1.89543 1 3V39C1 40.1046 1.89543 41 3 41H184C185.105 41 186 40.1046 186 39V3C186 1.89543 185.105 1 184 1H3Z" fill="#4285F4"/></g><path d="M57.2139 23.4365C57.2139 22.999 57.0589 22.6618 56.749 22.4248C56.4437 22.1878 55.89 21.9486 55.0879 21.707C54.2858 21.4655 53.6478 21.1966 53.1738 20.9004C52.2669 20.3307 51.8135 19.5879 51.8135 18.6719C51.8135 17.8698 52.1393 17.209 52.791 16.6895C53.4473 16.1699 54.2972 15.9102 55.3408 15.9102C56.0335 15.9102 56.651 16.0378 57.1934 16.293C57.7357 16.5482 58.1618 16.9128 58.4717 17.3867C58.7816 17.8561 58.9365 18.3779 58.9365 18.9521H57.2139C57.2139 18.4326 57.0498 18.027 56.7217 17.7354C56.3981 17.4391 55.9333 17.291 55.3271 17.291C54.762 17.291 54.3223 17.4118 54.0078 17.6533C53.6979 17.8949 53.543 18.2321 53.543 18.665C53.543 19.0296 53.7116 19.335 54.0488 19.5811C54.3861 19.8226 54.9421 20.0596 55.7168 20.292C56.4915 20.5199 57.1136 20.7819 57.583 21.0781C58.0524 21.3698 58.3965 21.707 58.6152 22.0898C58.834 22.4681 58.9434 22.9124 58.9434 23.4229C58.9434 24.2523 58.6243 24.9131 57.9863 25.4053C57.3529 25.8929 56.4915 26.1367 55.4023 26.1367C54.6823 26.1367 54.0192 26.0046 53.4131 25.7402C52.8115 25.4714 52.3421 25.1022 52.0049 24.6328C51.6722 24.1634 51.5059 23.6165 51.5059 22.9922H53.2354C53.2354 23.5573 53.4222 23.9948 53.7959 24.3047C54.1696 24.6146 54.7051 24.7695 55.4023 24.7695C56.0039 24.7695 56.4551 24.6488 56.7559 24.4072C57.0612 24.1611 57.2139 23.8376 57.2139 23.4365ZM62.2861 26H60.625V18.6035H62.2861V26ZM60.5225 16.6826C60.5225 16.4274 60.6022 16.2155 60.7617 16.0469C60.9258 15.8783 61.1582 15.7939 61.459 15.7939C61.7598 15.7939 61.9922 15.8783 62.1562 16.0469C62.3203 16.2155 62.4023 16.4274 62.4023 16.6826C62.4023 16.9333 62.3203 17.1429 62.1562 17.3115C61.9922 17.4756 61.7598 17.5576 61.459 17.5576C61.1582 17.5576 60.9258 17.4756 60.7617 17.3115C60.6022 17.1429 60.5225 16.9333 60.5225 16.6826ZM64.0293 22.2471C64.0293 21.0986 64.2982 20.1826 64.8359 19.499C65.3783 18.8109 66.096 18.4668 66.9893 18.4668C67.8324 18.4668 68.4954 18.7607 68.9785 19.3486L69.0537 18.6035H70.5508V25.7744C70.5508 26.7451 70.2477 27.5107 69.6416 28.0713C69.04 28.6318 68.2266 28.9121 67.2012 28.9121C66.6589 28.9121 66.1279 28.7982 65.6084 28.5703C65.0934 28.347 64.7015 28.0531 64.4326 27.6885L65.2188 26.6904C65.7292 27.2965 66.3581 27.5996 67.1055 27.5996C67.6569 27.5996 68.0921 27.4492 68.4111 27.1484C68.7301 26.8522 68.8896 26.4147 68.8896 25.8359V25.3369C68.4111 25.8701 67.7731 26.1367 66.9756 26.1367C66.1097 26.1367 65.401 25.7926 64.8496 25.1045C64.3027 24.4163 64.0293 23.4639 64.0293 22.2471ZM65.6836 22.3906C65.6836 23.1335 65.834 23.7191 66.1348 24.1475C66.4401 24.5713 66.8617 24.7832 67.3994 24.7832C68.0693 24.7832 68.5661 24.4961 68.8896 23.9219V20.668C68.5752 20.1074 68.083 19.8271 67.4131 19.8271C66.8662 19.8271 66.4401 20.0436 66.1348 20.4766C65.834 20.9095 65.6836 21.5475 65.6836 22.3906ZM74.0234 18.6035L74.0713 19.458C74.6182 18.7972 75.3359 18.4668 76.2246 18.4668C77.765 18.4668 78.5488 19.3486 78.5762 21.1123V26H76.915V21.208C76.915 20.7386 76.8125 20.3923 76.6074 20.1689C76.4069 19.9411 76.0765 19.8271 75.6162 19.8271C74.9463 19.8271 74.4473 20.1302 74.1191 20.7363V26H72.458V18.6035H74.0234ZM85.9658 26H84.3047V18.6035H85.9658V26ZM84.2021 16.6826C84.2021 16.4274 84.2819 16.2155 84.4414 16.0469C84.6055 15.8783 84.8379 15.7939 85.1387 15.7939C85.4395 15.7939 85.6719 15.8783 85.8359 16.0469C86 16.2155 86.082 16.4274 86.082 16.6826C86.082 16.9333 86 17.1429 85.8359 17.3115C85.6719 17.4756 85.4395 17.5576 85.1387 17.5576C84.8379 17.5576 84.6055 17.4756 84.4414 17.3115C84.2819 17.1429 84.2021 16.9333 84.2021 16.6826ZM89.541 18.6035L89.5889 19.458C90.1357 18.7972 90.8535 18.4668 91.7422 18.4668C93.2826 18.4668 94.0664 19.3486 94.0938 21.1123V26H92.4326V21.208C92.4326 20.7386 92.3301 20.3923 92.125 20.1689C91.9245 19.9411 91.5941 19.8271 91.1338 19.8271C90.4639 19.8271 89.9648 20.1302 89.6367 20.7363V26H87.9756V18.6035H89.541ZM106.214 23.71L107.39 18.6035H109.01L106.993 26H105.626L104.04 20.9209L102.481 26H101.114L99.0908 18.6035H100.711L101.907 23.6553L103.425 18.6035H104.676L106.214 23.71ZM112.106 26H110.445V18.6035H112.106V26ZM110.343 16.6826C110.343 16.4274 110.423 16.2155 110.582 16.0469C110.746 15.8783 110.979 15.7939 111.279 15.7939C111.58 15.7939 111.812 15.8783 111.977 16.0469C112.141 16.2155 112.223 16.4274 112.223 16.6826C112.223 16.9333 112.141 17.1429 111.977 17.3115C111.812 17.4756 111.58 17.5576 111.279 17.5576C110.979 17.5576 110.746 17.4756 110.582 17.3115C110.423 17.1429 110.343 16.9333 110.343 16.6826ZM116.222 16.8057V18.6035H117.527V19.834H116.222V23.9629C116.222 24.2454 116.276 24.4505 116.386 24.5781C116.5 24.7012 116.7 24.7627 116.987 24.7627C117.179 24.7627 117.372 24.7399 117.568 24.6943V25.9795C117.19 26.0843 116.826 26.1367 116.475 26.1367C115.199 26.1367 114.561 25.4326 114.561 24.0244V19.834H113.344V18.6035H114.561V16.8057H116.222ZM120.658 19.4102C121.201 18.7812 121.886 18.4668 122.716 18.4668C124.293 18.4668 125.092 19.3669 125.115 21.167V26H123.454V21.2285C123.454 20.7181 123.342 20.3581 123.119 20.1484C122.9 19.9342 122.577 19.8271 122.148 19.8271C121.483 19.8271 120.986 20.1234 120.658 20.7158V26H118.997V15.5H120.658V19.4102ZM138.514 24.708C138.154 25.1774 137.655 25.5329 137.017 25.7744C136.379 26.016 135.654 26.1367 134.843 26.1367C134.009 26.1367 133.271 25.9476 132.628 25.5693C131.985 25.1911 131.489 24.651 131.138 23.9492C130.791 23.2428 130.611 22.4202 130.598 21.4814V20.7021C130.598 19.1982 130.958 18.0247 131.678 17.1816C132.398 16.334 133.403 15.9102 134.692 15.9102C135.8 15.9102 136.679 16.1836 137.331 16.7305C137.983 17.2773 138.375 18.0658 138.507 19.0957H136.812C136.62 17.8971 135.925 17.2979 134.727 17.2979C133.952 17.2979 133.362 17.5781 132.956 18.1387C132.555 18.6947 132.348 19.5127 132.334 20.5928V21.3584C132.334 22.4339 132.56 23.2702 133.011 23.8672C133.466 24.4596 134.098 24.7559 134.904 24.7559C135.788 24.7559 136.417 24.5553 136.791 24.1543V22.2061H134.74V20.8936H138.514V24.708ZM140.161 22.2334C140.161 21.5088 140.305 20.8571 140.592 20.2783C140.879 19.695 141.282 19.2484 141.802 18.9385C142.321 18.624 142.918 18.4668 143.593 18.4668C144.591 18.4668 145.4 18.7881 146.02 19.4307C146.644 20.0732 146.981 20.9255 147.031 21.9873L147.038 22.377C147.038 23.1061 146.897 23.7578 146.614 24.332C146.336 24.9062 145.935 25.3506 145.411 25.665C144.892 25.9795 144.29 26.1367 143.606 26.1367C142.563 26.1367 141.727 25.7904 141.098 25.0977C140.473 24.4004 140.161 23.473 140.161 22.3154V22.2334ZM141.822 22.377C141.822 23.138 141.979 23.735 142.294 24.168C142.608 24.5964 143.046 24.8105 143.606 24.8105C144.167 24.8105 144.602 24.5918 144.912 24.1543C145.227 23.7168 145.384 23.0765 145.384 22.2334C145.384 21.486 145.222 20.8936 144.898 20.4561C144.579 20.0186 144.144 19.7998 143.593 19.7998C143.05 19.7998 142.62 20.0163 142.301 20.4492C141.982 20.8776 141.822 21.5202 141.822 22.377ZM148.351 22.2334C148.351 21.5088 148.494 20.8571 148.781 20.2783C149.068 19.695 149.472 19.2484 149.991 18.9385C150.511 18.624 151.108 18.4668 151.782 18.4668C152.78 18.4668 153.589 18.7881 154.209 19.4307C154.833 20.0732 155.171 20.9255 155.221 21.9873L155.228 22.377C155.228 23.1061 155.086 23.7578 154.804 24.332C154.526 24.9062 154.125 25.3506 153.601 25.665C153.081 25.9795 152.479 26.1367 151.796 26.1367C150.752 26.1367 149.916 25.7904 149.287 25.0977C148.663 24.4004 148.351 23.473 148.351 22.3154V22.2334ZM150.012 22.377C150.012 23.138 150.169 23.735 150.483 24.168C150.798 24.5964 151.235 24.8105 151.796 24.8105C152.356 24.8105 152.792 24.5918 153.102 24.1543C153.416 23.7168 153.573 23.0765 153.573 22.2334C153.573 21.486 153.411 20.8936 153.088 20.4561C152.769 20.0186 152.334 19.7998 151.782 19.7998C151.24 19.7998 150.809 20.0163 150.49 20.4492C150.171 20.8776 150.012 21.5202 150.012 22.377ZM156.561 22.2471C156.561 21.0986 156.829 20.1826 157.367 19.499C157.91 18.8109 158.627 18.4668 159.521 18.4668C160.364 18.4668 161.027 18.7607 161.51 19.3486L161.585 18.6035H163.082V25.7744C163.082 26.7451 162.779 27.5107 162.173 28.0713C161.571 28.6318 160.758 28.9121 159.732 28.9121C159.19 28.9121 158.659 28.7982 158.14 28.5703C157.625 28.347 157.233 28.0531 156.964 27.6885L157.75 26.6904C158.26 27.2965 158.889 27.5996 159.637 27.5996C160.188 27.5996 160.623 27.4492 160.942 27.1484C161.261 26.8522 161.421 26.4147 161.421 25.8359V25.3369C160.942 25.8701 160.304 26.1367 159.507 26.1367C158.641 26.1367 157.932 25.7926 157.381 25.1045C156.834 24.4163 156.561 23.4639 156.561 22.2471ZM158.215 22.3906C158.215 23.1335 158.365 23.7191 158.666 24.1475C158.971 24.5713 159.393 24.7832 159.931 24.7832C160.601 24.7832 161.097 24.4961 161.421 23.9219V20.668C161.106 20.1074 160.614 19.8271 159.944 19.8271C159.397 19.8271 158.971 20.0436 158.666 20.4766C158.365 20.9095 158.215 21.5475 158.215 22.3906ZM166.78 26H165.119V15.5H166.78V26ZM172.071 26.1367C171.019 26.1367 170.164 25.8063 169.508 25.1455C168.856 24.4801 168.53 23.596 168.53 22.4932V22.2881C168.53 21.5498 168.672 20.8913 168.954 20.3125C169.241 19.7292 169.642 19.2757 170.157 18.9521C170.672 18.6286 171.246 18.4668 171.88 18.4668C172.887 18.4668 173.664 18.7881 174.211 19.4307C174.762 20.0732 175.038 20.9824 175.038 22.1582V22.8281H170.205C170.255 23.4388 170.458 23.9219 170.813 24.2773C171.174 24.6328 171.625 24.8105 172.167 24.8105C172.928 24.8105 173.548 24.5029 174.026 23.8877L174.922 24.7422C174.626 25.1842 174.229 25.5283 173.732 25.7744C173.24 26.016 172.687 26.1367 172.071 26.1367ZM171.873 19.7998C171.417 19.7998 171.048 19.9593 170.766 20.2783C170.488 20.5973 170.31 21.0417 170.232 21.6113H173.397V21.4883C173.361 20.9323 173.213 20.513 172.953 20.2305C172.693 19.9434 172.333 19.7998 171.873 19.7998Z" fill="white"/><path fill-rule="evenodd" clip-rule="evenodd" d="M3 2C2.44772 2 2 2.44772 2 3V39C2 39.5523 2.44772 40 3 40H39C39.5523 40 40 39.5523 40 39V3C40 2.44772 39.5523 2 39 2H3Z" fill="white"/><path fill-rule="evenodd" clip-rule="evenodd" d="M29.64 21.2046C29.64 20.5664 29.5827 19.9527 29.4764 19.3636H21V22.845H25.8436C25.635 23.97 25.0009 24.9232 24.0477 25.5614V27.8196H26.9564C28.6582 26.2527 29.64 23.9455 29.64 21.2046Z" fill="#4285F4"/><path fill-rule="evenodd" clip-rule="evenodd" d="M21 30C23.43 30 25.4673 29.1941 26.9564 27.8195L24.0477 25.5614C23.2418 26.1014 22.2109 26.4204 21 26.4204C18.6559 26.4204 16.6718 24.8373 15.9641 22.71H12.9573V25.0418C14.4382 27.9832 17.4818 30 21 30Z" fill="#34A853"/><path fill-rule="evenodd" clip-rule="evenodd" d="M15.9641 22.71C15.7841 22.17 15.6818 21.5932 15.6818 21C15.6818 20.4068 15.7841 19.83 15.9641 19.29V16.9582H12.9573C12.3477 18.1732 12 19.5477 12 21C12 22.4523 12.3477 23.8268 12.9573 25.0418L15.9641 22.71Z" fill="#FBBC05"/><path fill-rule="evenodd" clip-rule="evenodd" d="M21 15.5795C22.3214 15.5795 23.5077 16.0336 24.4405 16.9255L27.0218 14.3441C25.4632 12.8918 23.4259 12 21 12C17.4818 12 14.4382 14.0168 12.9573 16.9582L15.9641 19.29C16.6718 17.1627 18.6559 15.5795 21 15.5795Z" fill="#EA4335"/><defs><filter id="filter0_dd" x="0" y="0" width="187" height="43" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dy="1"/><feGaussianBlur stdDeviation="0.5"/><feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.24 0"/><feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow"/><feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset/><feGaussianBlur stdDeviation="0.5"/><feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.12 0"/><feBlend mode="normal" in2="effect1_dropShadow" result="effect2_dropShadow"/><feBlend mode="normal" in="SourceGraphic" in2="effect2_dropShadow" result="shape"/></filter></defs></svg>';
var overlay2 = '<div tabindex="0" id="slidesoverlay" style="align-items:center!important;padding-top: 0px!important;" class="header_modal--modalBackground--3fkKH js-fullscreen-prevent-event-capture  header_modal--fixedTop--34GrB"><div id="innerslides" class="header_modal--modal--3V0h3 modal--modalShadow--HbHkT" style="max-width: 600px; min-width: 348px;"><div class=""><div class="header_modal--header--c8kL6 text--whiteText--x776v" style="text-indent:10px;">Convert to Google Slides</div><div class="permissions_modal--contentContainer--Vmhg3"><div class="permissions_modal--roleRows--2EnhA overflow--overflowYAuto--2H5Wf overflow--momentumScroll--2_z54"><h1 style="font-size: 16px;line-height:30px;font-weight: bold;padding-top:20px;">To begin using this extension, you must first sign in with Google</h1><h2 style="font-size: 12px;margin-top: 10px;line-height: 30px;">This extension uses the Google Drive API to view the file permissions & modify the contents of your Google Slides presentation.</h2></div><div id="googlebutton" style="margin-top: 20px;cursor:pointer;width:fit-content;transition-property: opacity;transition-duration: .3s;transition-timing-function: cubic-bezier(.8,.03,.25,1);">'+googleButton+'</div><h3 style="margin-top: 20px;color: #CACACA;padding-bottom:20px;">This extension was built by <a href="https://twitter.com/alyssaxuu" id="myname" target="_blank" style="color: #46BDFF!important;cursor: pointer;font-weight: 500;">Alyssa X</a>.</h3></div></div></div></div>';
var tempinput = '<form class="permissions_modal--inviteForm--22129"><div class="permissions_modal--autocompleteWrapper--Xhj0t" style="display:inline-block;width:400px;padding-right:20px;"><div class="permissions_modal--inviteInputWrapper--2qRip"><div class="autocomplete_input--container--3VOsw permissions_modal--autocompleteInput--1a0FC"><input type="text" id="slidesid" class="autocomplete_input--noTokens--3OAwj autocomplete_input--input--GaHQC autocomplete_input--tokenUnit--2_Bx1 autocomplete_input--tokenPadding--1odgI lazy_input--lazyInput--2kTZE" style="border-width: 0 0 1px;border-color: #f0f0f0;outline: 0;" placeholder="Your personal Figma API key" value=""></div></div><div></div></div><button disabled="" id="runscript" class="basic_form--primaryBtn--3NqnQ basic_form--btn--3A-Ju ellipsis--ellipsis--1RWY6 " style="display:inline-block;">Submit</button></form>';
var tempinput2 = '<form class="permissions_modal--inviteForm--22129"><div class="permissions_modal--autocompleteWrapper--Xhj0t" style="display:inline-block;width:400px;padding-right:20px;"><div class="permissions_modal--inviteInputWrapper--2qRip"><div class="autocomplete_input--container--3VOsw permissions_modal--autocompleteInput--1a0FC"><input type="text" id="slidesid2" class="autocomplete_input--noTokens--3OAwj autocomplete_input--input--GaHQC autocomplete_input--tokenUnit--2_Bx1 autocomplete_input--tokenPadding--1odgI lazy_input--lazyInput--2kTZE" style="border-width: 0 0 1px;border-color: #f0f0f0;outline: 0;" placeholder="Your Google Slides presentation URL" value=""></div></div><div></div></div><button disabled="" id="runscript2" class="basic_form--primaryBtn--3NqnQ basic_form--btn--3A-Ju ellipsis--ellipsis--1RWY6 " style="display:inline-block;">Convert</button></form>';
var overlay3 = '<div tabindex="0" id="slidesoverlay" style="align-items:center!important;padding-top: 0px!important;" class="header_modal--modalBackground--3fkKH js-fullscreen-prevent-event-capture  header_modal--fixedTop--34GrB"><div id="innerslides" class="header_modal--modal--3V0h3 modal--modalShadow--HbHkT" style="max-width: 600px; min-width: 348px;"><div class=""><div class="header_modal--header--c8kL6 text--whiteText--x776v" style="text-indent:10px;">Convert to Google Slides</div><div class="permissions_modal--contentContainer--Vmhg3"><div class="permissions_modal--roleRows--2EnhA overflow--overflowYAuto--2H5Wf overflow--momentumScroll--2_z54"><h1 style="font-size: 16px;line-height:30px;font-weight: bold;padding-top:20px;">Almost done! Simply add your personal Figma API key below</h1><h2 style="font-size: 12px;margin-top: 10px;line-height: 30px;">With your Figma key, the extension will be able to view the different frames contained within any of your files and export them to Google Slides.</h2></div><div id="googlebutton" style="margin-top:15px;">'+tempinput+'</div><h3 style="margin-top: 20px;color: #CACACA;padding-bottom: 20px;">Don&#39;t have a key? Generate your personal Figma API key <a id="myname" href="https://www.figma.com/developers/docs#access-tokens" target="_blank" style="color: #46BDFF!important;cursor: pointer;font-weight: 500;">here</a>.</h3></div></div></div></div>';
var overlay4 = '<div tabindex="0" id="slidesoverlay" style="align-items:center!important;padding-top: 0px!important;" class="header_modal--modalBackground--3fkKH js-fullscreen-prevent-event-capture  header_modal--fixedTop--34GrB"><div id="innerslides" class="header_modal--modal--3V0h3 modal--modalShadow--HbHkT" style="max-width: 600px; min-width: 348px;"><div class=""><div class="header_modal--header--c8kL6 text--whiteText--x776v" style="text-indent:10px;">Convert to Google Slides</div><div class="permissions_modal--contentContainer--Vmhg3"><div class="permissions_modal--roleRows--2EnhA overflow--overflowYAuto--2H5Wf overflow--momentumScroll--2_z54"><h1 style="font-size: 16px;margin-top: 25px;line-height:30px;font-weight: bold;">Convert your file to a Google Slides presentation</h1><h2 style="font-size: 12px;margin-top: 10px;line-height: 30px;">Your Figma frames will be automatically converted to slides in your presentation, ordered from top to bottom, from the first page. Recommended frame dimensions: 1280x720.</h2></div><div id="googlebutton" style="margin-top:15px;">'+tempinput2+'</div><h3 style="margin-top: 20px;color: #CACACA;padding-bottom:20px;">This extension was made by <a href="https://twitter.com/alyssaxuu" target="_blank" id="myname" style="color: #46BDFF!important;cursor: pointer;font-weight: 500;">Alyssa X</a>.</h3></div></div></div></div>';
overlay = false;
test = false;
	document.addEventListener("click", function (event) {
		var clickedElem = event.target;
		if (event.target.id != "innerslides" && clickedElem.id != "chromeadd" && overlay == true && !document.getElementById("innerslides").contains(event.target)){
			overlay = false;
			document.getElementById("slidesoverlay").style.visibility = "hidden";
			document.getElementById("googlebutton").style.visibility = "hidden";
			test=false;
			document.getElementById("chromeadd").style.backgroundColor = "#2c2c2c";
	}
	}, false);
var state = 0;
var state2 = 0;
chrome.runtime.sendMessage({type: "startup"}, function(response) {
	if (response.state == "logged in") {
		state = 1;
	} else {
		state = 0;
	}
	});
chrome.runtime.sendMessage({type: "figmastartup"}, function(response) {
	if (response.state == "logged in") {
		state2 = 1;
	} else {
		state2 = 0;
	}
	});
function isLoaded() {
	if (document.getElementsByClassName("toolbar_view--buttonGroup--2wM3n")[0]) {
		run();
	} else {
		 setTimeout(isLoaded, 100);
	}
}
isLoaded();
function run() {
	x = document.getElementsByClassName("toolbar_view--buttonGroup--2wM3n");
	y = document.getElementsByClassName("in_app_page--content--2V_He");
	if (state == 0) {
		y[0].insertAdjacentHTML("beforeend", overlay2);
	} else if (state == 1 && state2 == 0) {
		y[0].insertAdjacentHTML("beforeend", overlay3);
	} else {
		y[0].insertAdjacentHTML("beforeend", overlay4);
	}
	x[0].insertAdjacentHTML("beforeend", save);
	document.getElementById("slidesoverlay").style.visibility = "hidden";
	$(document).ready(function(){
		function activateButton(){
		if (state2 == 1) {
			if (document.getElementById("slidesid2").value != "") {
				document.getElementById("runscript2").disabled = false;
			} else {
				document.getElementById("runscript2").disabled = true;
			}
			if (document.getElementById("alerttext")) {
				document.getElementById("alerttext").parentNode.removeChild(document.getElementById("alerttext"));
				document.getElementById("slidesid2").style.color = "#000";
			}
		} else if (state == 1) {
			if (document.getElementById("slidesid").value != "") {
				document.getElementById("runscript").disabled = false;
			} else {
				document.getElementById("runscript").disabled = true;
			}
			if (document.getElementById("alerttext")) {
				document.getElementById("alerttext").parentNode.removeChild(document.getElementById("alerttext"));
				document.getElementById("slidesid").style.color = "#000";
			}
		}
		}
		$(document).on("paste", "#slidesid", function(){
			activateButton();
		});
		$(document).on("change", "#slidesid", function(){
			activateButton();
		});
		$(document).on("keydown", "#slidesid", function(){
			activateButton();
		});
		$(document).on("keyup", "#slidesid", function(){
			activateButton();
		});
		$(document).on("blur", "#slidesid", function(){
			activateButton();
		});
		$(document).on("paste", "#slidesid2", function(){
			activateButton();
		});
		$(document).on("change", "#slidesid2", function(){
			activateButton();
		});
		$(document).on("keydown", "#slidesid2", function(){
			activateButton();
		});
		$(document).on("keyup", "#slidesid2", function(){
			activateButton();
		});
		$(document).on("blur", "#slidesid2", function(){
			activateButton();
		});
		$(document).on('click','#innerslides',function(e){
			if (e.target.id) {
				if (e.target.id != "myname") {
					e.preventDefault();  
				}
			} else {
				e.preventDefault();
			}
		});
		$(document).on('click','#googlebutton',function(e){
			if (state == 0) {
			chrome.runtime.sendMessage({type: "getUrls"}, function(response) {
				if (response.token) {
					document.getElementById("slidesoverlay").outerHTML = overlay3;
					state = 1;
				} else {
					var alertmsg = '<div id="alerttext" style="margin-top:20px;"><svg style="display: inline-block;margin-right: 5px;margin-bottom: -2px;" width="14" height="13" viewBox="0 0 14 13" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="7.09473" cy="9.30981" r="1" fill="#CF0B22"/><path d="M6.09718 1.5616L1.15634 9.80993C1.05448 9.98635 1.00057 10.1864 1 10.3901C0.999434 10.5938 1.05221 10.7941 1.15309 10.9711C1.25397 11.1481 1.39943 11.2955 1.57501 11.3988C1.75058 11.5022 1.95014 11.5577 2.15384 11.5599H12.0355C12.2392 11.5577 12.4388 11.5022 12.6143 11.3988C12.7899 11.2955 12.9354 11.1481 13.0363 10.9711C13.1371 10.7941 13.1899 10.5938 13.1894 10.3901C13.1888 10.1864 13.1349 9.98635 13.033 9.80993L8.09218 1.5616C7.98819 1.39016 7.84177 1.24842 7.66704 1.15005C7.49232 1.05168 7.29519 1 7.09468 1C6.89417 1 6.69704 1.05168 6.52231 1.15005C6.34759 1.24842 6.20117 1.39016 6.09718 1.5616V1.5616Z" stroke="#CF0B22" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/><path d="M7.09473 4.55981V6.89315" stroke="#CF0B22" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg><span style="color:#DA144F;display: inline-block;">Could not sign you in. Make sure you give this extension the requested permissions to proceed.</span></div>';
					document.getElementById("googlebutton").insertAdjacentHTML("afterend",alertmsg);
				}
			});
		}
		});
		function getIdFromUrl(url) {
			return url.match(/[-\w]{25,}/);
		}
		$(document).on('click','#runscript2',function(e){
			if (document.getElementById("alerttext")) {
				document.getElementById("alerttext").parentNode.removeChild(document.getElementById("alerttext"));
				document.getElementById("slidesid2").style.color = "#000";
			}
			var fileID = getIdFromUrl(document.getElementById("slidesid2").value);
			document.getElementById("runscript2").innerHTML = "Loading...";
			document.getElementById("slidesid2").disabled = true;	
			chrome.runtime.sendMessage({type: "googleapi", file: fileID, figma:window.location.href.split("https://www.figma.com/file/").pop().split("/")[0]}, function(response) {
				if (response.type == "success") {
					document.getElementById("slidesid2").disabled = false;
					document.getElementById("runscript2").innerHTML = "Convert";
					var alertmsg = '<div id="alerttext" style="margin-top:20px;"><svg style="display: inline-block;margin-right: 5px;margin-bottom: -2px;" width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M13 6.45143V7.00343C12.9993 8.29728 12.5803 9.55623 11.8056 10.5925C11.0309 11.6288 9.94196 12.3869 8.70121 12.7538C7.46045 13.1206 6.13435 13.0766 4.92068 12.6282C3.70701 12.1798 2.67079 11.3511 1.96658 10.2657C1.26236 9.18025 0.927875 7.89627 1.01301 6.60522C1.09814 5.31417 1.59832 4.08523 2.43897 3.10168C3.27961 2.11812 4.41567 1.43266 5.67771 1.14752C6.93975 0.86238 8.26015 0.992836 9.442 1.51943" stroke="#90CF0B" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/><path d="M12.9999 2.20337L6.99995 8.20936L5.19995 6.40937" stroke="#90CF0B" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg><span style="color:#90CF0B;display: inline-block;">Successfully converted your Figma frames into slides!</span></div>';
					document.getElementById("googlebutton").insertAdjacentHTML("afterend",alertmsg);
				} else if (response.type == "error") {
					document.getElementById("slidesid2").disabled = false;
					document.getElementById("runscript2").innerHTML = "Convert";
					var alertmsg = '<div id="alerttext" style="margin-top:20px;"><svg style="display: inline-block;margin-right: 5px;margin-bottom: -2px;" width="14" height="13" viewBox="0 0 14 13" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="7.09473" cy="9.30981" r="1" fill="#CF0B22"/><path d="M6.09718 1.5616L1.15634 9.80993C1.05448 9.98635 1.00057 10.1864 1 10.3901C0.999434 10.5938 1.05221 10.7941 1.15309 10.9711C1.25397 11.1481 1.39943 11.2955 1.57501 11.3988C1.75058 11.5022 1.95014 11.5577 2.15384 11.5599H12.0355C12.2392 11.5577 12.4388 11.5022 12.6143 11.3988C12.7899 11.2955 12.9354 11.1481 13.0363 10.9711C13.1371 10.7941 13.1899 10.5938 13.1894 10.3901C13.1888 10.1864 13.1349 9.98635 13.033 9.80993L8.09218 1.5616C7.98819 1.39016 7.84177 1.24842 7.66704 1.15005C7.49232 1.05168 7.29519 1 7.09468 1C6.89417 1 6.69704 1.05168 6.52231 1.15005C6.34759 1.24842 6.20117 1.39016 6.09718 1.5616V1.5616Z" stroke="#CF0B22" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/><path d="M7.09473 4.55981V6.89315" stroke="#CF0B22" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg><span style="color:#DA144F;display: inline-block;">Oops, there has been an issue with the Google API. Check that the URL is correct, and try again.</span></div>';
					document.getElementById("googlebutton").insertAdjacentHTML("afterend",alertmsg);
				} else if (response.type == "no frames") {
					document.getElementById("slidesid2").disabled = false;
					document.getElementById("runscript2").innerHTML = "Convert";
					var alertmsg = '<div id="alerttext" style="margin-top:20px;"><svg style="display: inline-block;margin-right: 5px;margin-bottom: -2px;" width="14" height="13" viewBox="0 0 14 13" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="7.09473" cy="9.30981" r="1" fill="#CF0B22"/><path d="M6.09718 1.5616L1.15634 9.80993C1.05448 9.98635 1.00057 10.1864 1 10.3901C0.999434 10.5938 1.05221 10.7941 1.15309 10.9711C1.25397 11.1481 1.39943 11.2955 1.57501 11.3988C1.75058 11.5022 1.95014 11.5577 2.15384 11.5599H12.0355C12.2392 11.5577 12.4388 11.5022 12.6143 11.3988C12.7899 11.2955 12.9354 11.1481 13.0363 10.9711C13.1371 10.7941 13.1899 10.5938 13.1894 10.3901C13.1888 10.1864 13.1349 9.98635 13.033 9.80993L8.09218 1.5616C7.98819 1.39016 7.84177 1.24842 7.66704 1.15005C7.49232 1.05168 7.29519 1 7.09468 1C6.89417 1 6.69704 1.05168 6.52231 1.15005C6.34759 1.24842 6.20117 1.39016 6.09718 1.5616V1.5616Z" stroke="#CF0B22" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/><path d="M7.09473 4.55981V6.89315" stroke="#CF0B22" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg><span style="color:#DA144F;display: inline-block;">Oops, there are no frames in your Figma file. Remember only frames are turned into slides!</span></div>';
					document.getElementById("googlebutton").insertAdjacentHTML("afterend",alertmsg);
				} else if (response.type == "figma error") {
					document.getElementById("slidesid2").disabled = false;
					document.getElementById("runscript2").innerHTML = "Convert";
					var alertmsg = '<div id="alerttext" style="margin-top:20px;"><svg style="display: inline-block;margin-right: 5px;margin-bottom: -2px;" width="14" height="13" viewBox="0 0 14 13" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="7.09473" cy="9.30981" r="1" fill="#CF0B22"/><path d="M6.09718 1.5616L1.15634 9.80993C1.05448 9.98635 1.00057 10.1864 1 10.3901C0.999434 10.5938 1.05221 10.7941 1.15309 10.9711C1.25397 11.1481 1.39943 11.2955 1.57501 11.3988C1.75058 11.5022 1.95014 11.5577 2.15384 11.5599H12.0355C12.2392 11.5577 12.4388 11.5022 12.6143 11.3988C12.7899 11.2955 12.9354 11.1481 13.0363 10.9711C13.1371 10.7941 13.1899 10.5938 13.1894 10.3901C13.1888 10.1864 13.1349 9.98635 13.033 9.80993L8.09218 1.5616C7.98819 1.39016 7.84177 1.24842 7.66704 1.15005C7.49232 1.05168 7.29519 1 7.09468 1C6.89417 1 6.69704 1.05168 6.52231 1.15005C6.34759 1.24842 6.20117 1.39016 6.09718 1.5616V1.5616Z" stroke="#CF0B22" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/><path d="M7.09473 4.55981V6.89315" stroke="#CF0B22" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg><span style="color:#DA144F;display: inline-block;">Oops, there are no frames in your Figma file. Remember only frames are turned into slides!</span></div>';
					document.getElementById("googlebutton").insertAdjacentHTML("afterend",alertmsg);
				}
			});
		});
		$(document).on('hover', '#googlebutton', function(){
			document.getElementById("googlebutton").style.opacity = .5;
		}, function(){
				document.getElementById("googlebutton").style.opacity = 1;
		});
		$(document).on('click', '#chromeadd', function(){
			test = true;
			document.getElementById("chromeadd").style.backgroundColor = "#18a0fb";
			document.getElementById("slidesoverlay").style.visibility = "visible";
			document.getElementById("googlebutton").style.visibility = "visible";
			setTimeout(function () {
				overlay=true;
			},1000);
		})
		$(document).on({
			mouseenter: function () {
				if (!test){
					document.getElementById("chromeadd").style.backgroundColor = "black";
				}
			},
    		mouseleave: function () {
				if (!test) {
					document.getElementById("chromeadd").style.backgroundColor = "#2c2c2c";
				}
    		}
		}, '#chromeadd');
		$(document).on('click','#runscript',function(e){
			document.getElementById("runscript").innerHTML = "Loading...";
document.getElementById("slidesid").disabled = true;
var figmaKey = document.getElementById("slidesid").value;
let init3 = {
	method: 'GET',
	headers: {
		'X-Figma-Token': figmaKey
	}
};
	fetch('https://api.figma.com/v1/files/'+window.location.href.split("https://www.figma.com/file/").pop().split("/")[0],init3).then((response) => response.json()).then(function(data) {
		if (data["document"]) {
			chrome.runtime.sendMessage({type: "figmakey", key: figmaKey}, function(response) {
				document.getElementById("slidesoverlay").outerHTML = overlay4;
				document.getElementById("innerslides").style.transition = "transform .3s cubic-bezier(.8,.03,.25,1)";
				setTimeout(function(){
					document.getElementById("innerslides").style.transform = "scale(1.05)";
				}, 10);
				setTimeout(function(){ 
					document.getElementById("innerslides").style.transform = "scale(1)";
				}, 200);
				state2 = 1;
			});
		} else {
			document.getElementById("slidesid").disabled = false;
			document.getElementById("runscript").innerHTML = "Submit";
			document.getElementById("slidesid").style.color = "#DA144F";
			var alertmsg = '<div id="alerttext" style="margin-top:20px;"><svg style="display: inline-block;margin-right: 5px;margin-bottom: -2px;" width="14" height="13" viewBox="0 0 14 13" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="7.09473" cy="9.30981" r="1" fill="#CF0B22"/><path d="M6.09718 1.5616L1.15634 9.80993C1.05448 9.98635 1.00057 10.1864 1 10.3901C0.999434 10.5938 1.05221 10.7941 1.15309 10.9711C1.25397 11.1481 1.39943 11.2955 1.57501 11.3988C1.75058 11.5022 1.95014 11.5577 2.15384 11.5599H12.0355C12.2392 11.5577 12.4388 11.5022 12.6143 11.3988C12.7899 11.2955 12.9354 11.1481 13.0363 10.9711C13.1371 10.7941 13.1899 10.5938 13.1894 10.3901C13.1888 10.1864 13.1349 9.98635 13.033 9.80993L8.09218 1.5616C7.98819 1.39016 7.84177 1.24842 7.66704 1.15005C7.49232 1.05168 7.29519 1 7.09468 1C6.89417 1 6.69704 1.05168 6.52231 1.15005C6.34759 1.24842 6.20117 1.39016 6.09718 1.5616V1.5616Z" stroke="#CF0B22" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/><path d="M7.09473 4.55981V6.89315" stroke="#CF0B22" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg><span style="color:#DA144F;display: inline-block;">The key you entered is invalid. Try following the instructions below & insert it again.</span></div>';
			document.getElementById("googlebutton").insertAdjacentHTML("afterend",alertmsg);
		}
	});

		});
});
}



